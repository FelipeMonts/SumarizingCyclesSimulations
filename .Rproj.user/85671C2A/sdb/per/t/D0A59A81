{
    "collab_server" : "",
    "contents" : "##############################################################################################################################\n#\n#  Program to visualize N2O Rose Simulation summary by Dr. Debasish Saha.\n#\n#  Felipe Montes,  2016/06/08\n#\n##############################################################################################################################\n\n\n\n\n\n\n###############################################################################################################\n#                          Loading Packages and setting up working directory                        \n###############################################################################################################\n\n\n\n#  Tell the program where the package libraries are  #####################\n\n\n.libPaths(\"C:/Felipe/R_Library/library\")\n\n#  Set Working directory\n\nsetwd(\"C:\\\\Felipe\\\\OrganicTransitions_N2OROSE\\\\CyclesSimulation\\\\SahaN2ORoseSimulations\\\\SimulationFolders\");\n\n\n#  Inlcude the necesary packages\n\nlibrary(lattice); \n\noptions(java.parameters = \"-Xmx4g\" ); \n\n#  options(java.parameters = \"-Xmx1024m\" );\n\nlibrary(XLConnect);\n\n\n\n# Create a directoty to collect the grphs sumarizing the simulations \n\ndir.create(\"..\\\\OutputSummary\\\\Graphics\");  \n\n\n\n###############################################################################################################\n#                          Code to extract excell columns by letter name                                  \n###############################################################################################################\n\n\n# Line of codes to convert exell column names to couln numbers to easy extraction in R\n\nExcel.Columns<-c(LETTERS, paste0(\"A\",LETTERS),paste0(\"B\",LETTERS),paste0(\"C\",LETTERS));\n\n\n###############################################################################################################\n#                        Code to plot the roation system used in the simulations\n###############################################################################################################\n\n\n## Read the  crop rotation files\n\nCrop_Rotaion_Header<-readWorksheetFromFile(\"ManureasbyWade_Setting.xls\", sheet = \"Planting Order\", startRow = 4,endRow = 5,header=F) ;\n\nCrop_Rotaion_ColNames<-paste(Crop_Rotaion_Header[1,],Crop_Rotaion_Header[2,],sep=\"_\");\n\nCrop_Rotaion<-readWorksheetFromFile(\"ManureasbyWade_Setting.xls\", sheet = \"Planting Order\", startRow = 6,header=F) ;\n\nnames(Crop_Rotaion)<-Crop_Rotaion_ColNames[1:3] ;\n\n\n\n\n##  Add the 4 years of rotation with alfalfa\n\nfix(Crop_Rotaion) ;\n#    Rotation_Year Calendar_Day    Crop_Name\n# 1              1          141        Maize\n# 2              1          310   Winter Rye\n# 3              2          146      Soybean\n# 4              2          306 Winter Wheat\n# 5              3          249   Red Clover\n# 6              4          141        Maize\n# 7              4          310   Winter Rye\n# 8              5          146      Soybean\n# 9              5          306 Winter Wheat\n# 10             6          243      Alfalfa\n# 11            10          365      Alfalfa\n# 12             1            1      Alfalfa\n\nCrop_Rotaion<-Crop_Rotaion[order(Crop_Rotaion$Rotation_Year,Crop_Rotaion$Calendar_Day),] ;\n\n\n\n\n## Convert the Rotation year and Calendar Year to a one variable to be plotted in the staked horizontal bars\n\n\nCrop_Rotaion$DaysPlanted<-((Crop_Rotaion$Rotation_Year-1)*365)+Crop_Rotaion$Calendar_Day ;\n\nCrop_Rotaion$DaysAfterPlanting<-c(0,Crop_Rotaion$DaysPlanted[2:12]-Crop_Rotaion$DaysPlanted[1:11]) ;\n\n\n##  Combine the Roations into a thought experiment in which each year rotation changes by a year\n\nCrop_Rotaion$\n\nbarplot(Crop_Rotaion$DaysAfterPlanting, names.arg = Crop_Rotaion$Crop_Name )  ;\n\n\n\n\n###############################################################################################################\n#              Code to plot the relationship between cover crop Biomass before planting and Transpiration\n###############################################################################################################\n\n\n### Select the spreadsheet columns to be read from the Spreadsheet. \n\n\nColumnsSeason_Output<-which(Excel.Columns %in% c(\"A\", \"B\" , \"E\" , \"F\" ,\"G\", \"H\" , \"I\", \"K\" ));\n\n\n\n### Read the data from the Season_Output spreadsheet in the summary Excell workbook\n\n\nSeason_Output<-readWorksheetFromFile(\"..\\\\OutputSummary\\\\CyclesOutputSummary.xlsx\", sheet = \"Season_Output\", startRow = 1, header=T, keep=ColumnsSeason_Output);\n\n\n###  Select the years with Red Clover\n\n\nRedClover.Season_Output<-Season_Output[Season_Output$NA_NA_Crop == \"Red Clover\",] ;\n\n\n### plot Time Series of Above ground residue\n\n\nplot(RedClover.Season_Output$NA_NA_Date,RedClover.Season_Output$Aboveground_Residue_Mg.ha,pch=19,col=\"RED\") ;\n\n\n### Plot Transpiration vs Above ground biomass\n\n\nplot(RedClover.Season_Output$Potential_Transpiration_mm,RedClover.Season_Output$Aboveground_Residue_Mg.ha, pch=19, col=\"RED\") \n# points(RedClover.Season_Output$Actual_Transpiration_mm,RedClover.Season_Output$Aboveground_Residue_Mg.ha, pch=19, col=\"BLUE\") ;  For Red Clover have Zero water deficit and therefore Potential and Actual traspiration are the same\n\n\n###  Select the years with Alfalfa\n\n\nAlfalfa.Season_Output<-Season_Output[Season_Output$NA_NA_Crop == \"Alfalfa\",] ;\n\n## adding a year colum to the data set\n\nAlfalfa.Season_Output$Year<-format(Alfalfa.Season_Output$NA_NA_Date,format=\"%Y\") ;\n\n\n### plot Time Series of Above ground residue\n\n\nplot(Alfalfa.Season_Output$NA_NA_Date,Alfalfa.Season_Output$Aboveground_Residue_Mg.ha,pch=19,col=\"RED\") ;\n\n\n### Plot Transpiration vs Above ground biomass\n\n\nplot(Alfalfa.Season_Output$Potential_Transpiration_mm,Alfalfa.Season_Output$Aboveground_Residue_Mg.ha, pch=19, col=\"RED\") ;\npoints(Alfalfa.Season_Output$Actual_Transpiration_mm,Alfalfa.Season_Output$Aboveground_Residue_Mg.ha, pch=19, col=\"BLUE\") ;  \n\n\n### Order the Output by year\n\nAlfalfa.Season_Output<-Alfalfa.Season_Output[order(Alfalfa.Season_Output$NA_NA_Date),];\n\n\n###  Combine the Red Clover and Alfalfa Residue plots into a 2 by two series of graphs;\n\n\n\npdf(file=\"..\\\\OutputSummary\\\\Graphics\\\\RodaleVisit.pdf\",onefile=T, width=17, height=11) ;\n\n\npar(mfrow = c(2,2)) ;\n\n\n# Residue Time Series\n\n\nplot(RedClover.Season_Output$NA_NA_Date,RedClover.Season_Output$Aboveground_Residue_Mg.ha, pch = 21, col = \"BLACK\",bg = \"RED\" , ylim = c(0,4), ylab = \"Fresh biomass  Mg/Ha\", main = \"Cover crop biomass before Corn\", xlab=\"\",cex=1.5);\npoints(Alfalfa.Season_Output$NA_NA_Date,Alfalfa.Season_Output$Aboveground_Residue_Mg.ha, pch=21 ,col = \"BLACK\" , bg = \"GREEN\", cex = 1.5) ;\nlegend(\"topleft\" , c(\"Red Clover\" , \"Alfalfa\"),fill=c(\"RED\",\"GREEN\"));\n\n\n# Residue and Evapotranspiration\n\nplot(RedClover.Season_Output$Actual_Transpiration_mm,RedClover.Season_Output$Aboveground_Residue_Mg.ha, pch = 21, col = \"BLACK\" , bg = \"RED\", cex =  1.5 ,ylim = c(0,4), xlim = c(10,170),ylab = \"Cover Crop biomass Mg/Ha\", xlab = \"Plant Transpiration mm\", main = \"Cover crop Biomass vs Transpiration\");\npoints(Alfalfa.Season_Output$Actual_Transpiration_mm,Alfalfa.Season_Output$Aboveground_Residue_Mg.ha, pch = 21 , col=\"BLACK\" , bg = \"GREEN\" , cex = 1.5 ) ; \nlegend(\"topleft\" , c(\"Red Clover\" , \"Alfalfa\"),fill=c(\"RED\",\"GREEN\"));\n\n\n\nbarplot(t(as.matrix(Alfalfa.Season_Output[,c(\"Root_Nitrogen_Mg.ha\",\"Forage_Nitrogen_Mg.ha\")])*1000),names.arg=Alfalfa.Season_Output$Year,las= 2,col=c(\"chocolate4\",\"darkgreen\"),ylab = c(\"Nitrogen Kg/Ha\"),main = \"Alfalfa before Corn\") ;\nlegend(\"topleft\",c(\"Root\",\"Forage\"), fill=c(\"chocolate4\",\"darkgreen\"));\n\n\n\ndev.off()\n\n\n# ##########################################################################################################\n# \n# \n# Create cumulative distribution plots of the plant biomass of alfalfa and red clover  before planting Corn\n# \n# \n# ##########################################################################################################\n\nRedclover_ecdf<-ecdf(RedClover.Season_Output$Aboveground_Residue_Mg.ha) ;\n\nAlfalfa_ecdf<-ecdf(Alfalfa.Season_Output$Aboveground_Residue_Mg.ha) ;\n\nsummary(Redclover_ecdf) ;\n\n\nplot(Alfalfa_ecdf, verticals= T , col.points=\"green\" , do.points=F, col.hor = \"green\", col.vert=\"green\",lwd =4, ylab=\"Cumulative distribution Cover crop Biomass\" ,xlab=\"Biomass Mg/Ha\", main=\"Cover crop Biomass before Corn Planting\") ;\n\nplot(Redclover_ecdf, verticals= T , col.points=\"red\" , do.points=F, col.hor = \"red\", col.vert=\"red\", lwd =4, add = T ) ;\n\nabline(h=0.5, col=\"blue\", lwd=2);\n\nlegend(\"topleft\",c(\"Red Clover\" , \"Alfalfa\"), col= c(\"red\" , \"green\"), fill=c(\"red\" , \"green\"), bty = \"n\" )\n\n\n\n\n\n\n",
    "created" : 1486155376789.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2381235999",
    "id" : "D0A59A81",
    "lastKnownWriteTime" : 1486162534,
    "last_content_update" : 1486162534,
    "path" : "C:/Felipe/OrganicTransitions_N2OROSE/CyclesSimulation/SumarizingCyclesSimulations/GraphicsOutput.R",
    "project_path" : "GraphicsOutput.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}